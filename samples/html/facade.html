!DOCTYPE html
html lang=en
head
    meta charset=UTF-8
    meta name=viewport content=width=device-width, initial-scale=1.0
    titleThe Facade Pattern - Interactive Animation/title
    
    !-- Libraries --
    script src=https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js/script
    link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css

    style
        :root {
            --bg-color: #1a1a2e;
            --primary: #ff6b6b;   /* Red/Pizza */
            --secondary: #4ecdc4; /* Teal/Safe */
            --accent: #ffe66d;    /* Yellow/Action */
            --text: #f7fff7;
            --chaos: #ff9f43;
            --wall: #2d3436;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background-color: var(--bg-color);
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Stage Area */
        #stage {
            position: relative;
            width: 100%;
            height: 100%;
            perspective: 1000px;
        }

        /* Subtitles */
        #subtitle-container {
            position: absolute;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            text-align: center;
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 30px;
            border-radius: 30px;
            z-index: 1000;
            backdrop-filter: blur(5px);
            opacity: 0; /* Hidden initially */
        }

        #subtitle-text {
            font-size: 1.5rem;
            font-weight: 600;
            letter-spacing: 1px;
            color: #fff;
        }

        /* Actors Elements */
        .actor {
            position: absolute;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0; /* Starts hidden */
        }

        /* Scene 1: Customer */
        #customer {
            top: 40%;
            left: 15%;
            font-size: 80px;
            color: var(--secondary);
            flex-direction: column;
        }
        
        #thought-bubble {
            position: absolute;
            top: -100px;
            right: -80px;
            background: #fff;
            color: var(--primary);
            padding: 20px;
            border-radius: 50%;
            font-size: 40px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transform: scale(0);
        }

        #thought-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 20px;
            border-width: 10px 10px 0;
            border-style: solid;
            border-color: #fff transparent;
            display: block;
            width: 0;
        }

        /* Scene 2: Kitchen Chaos */
        #kitchen {
            position: absolute;
            top: 20%;
            right: 10%;
            width: 500px;
            height: 400px;
            border: 2px dashed rgba(255,255,255,0.1);
            border-radius: 20px;
            overflow: visible;
        }

        .chaos-item {
            position: absolute;
            font-size: 40px;
            color: var(--chaos);
        }

        /* Scene 3: The Wall Facade */
        #wall {
            position: absolute;
            top: 0;
            right: 0;
            width: 60vw;
            height: 100vh;
            background: var(--wall);
            z-index: 10;
            transform: translateY(-100%); /* Start above */
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: -10px 0 30px rgba(0,0,0,0.5);
        }

        #facade-actor {
            position: absolute;
            top: 40%;
            left: 20%; /* Relative to wall */
            font-size: 100px;
            color: var(--accent);
            z-index: 11;
            display: flex;
            flex-direction: column;
            align-items: center;
            opacity: 0;
        }

        #facade-label {
            font-size: 24px;
            background: var(--primary);
            padding: 5px 15px;
            border-radius: 5px;
            margin-top: 10px;
            opacity: 0;
            font-family: monospace;
        }

        #order-btn {
            position: absolute;
            top: 50%;
            left: -150px; /* To the left of the facade */
            width: 120px;
            height: 120px;
            background: var(--secondary);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            font-size: 24px;
            color: #1a1a2e;
            box-shadow: 0 10px 0 #3db1a8;
            cursor: pointer;
            opacity: 0;
            transform: scale(0);
            z-index: 12;
            text-transform: uppercase;
        }

        #order-btn:active {
            box-shadow: 0 0 0 #3db1a8;
            transform: translateY(10px) scale(0.95);
        }

        /* Wires connecting Facade to Chaos */
        .wire {
            position: absolute;
            background: #555;
            z-index: 9;
        }

        #final-pizza {
            position: absolute;
            top: 40%;
            left: 55%; /* Starts at Facade position (approx) */
            font-size: 60px;
            color: var(--primary);
            z-index: 20;
            opacity: 0;
            transform-origin: center center;
        }

        /* Background texture for kitchen */
        .bg-pattern {
            position: absolute;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            background-image: radial-gradient(#ffffff 1px, transparent 1px);
            background-size: 20px 20px;
        }

    /style
/head
body

    div id=stage
        
        !-- Scene 1: User --
        div id=customer class=actor
            i class=fa-solid fa-user/i
            div id=thought-bubble
                i class=fa-solid fa-pizza-slice/i
            /div
        /div

        !-- Scene 2: Kitchen --
        div id=kitchen
            div class=bg-pattern/div
            !-- Chaos elements --
            div class=chaos-item style=top: 20%; left: 20%;i class=fa-solid fa-fire/i/div
            div class=chaos-item style=top: 60%; left: 70%;i class=fa-solid fa-utensils/i/div
            div class=chaos-item style=top: 40%; left: 50%;i class=fa-solid fa-user-ninja/i/div
            div class=chaos-item style=top: 10%; left: 80%;i class=fa-solid fa-bowl-food/i/div
            div class=chaos-item style=top: 80%; left: 30%;i class=fa-solid fa-cheese/i/div
        /div

        !-- Scene 3: The Facade System --
        div id=wall
            !-- Wires behind --
            div class=wire style=top: 45%; right: -200px; width: 300px; height: 5px;/div
            div class=wire style=top: 50%; right: -200px; width: 300px; height: 5px; transform: rotate(10deg);/div
            div class=wire style=top: 40%; right: -200px; width: 300px; height: 5px; transform: rotate(-10deg);/div

            !-- The Facade Actor --
            div id=facade-actor
                i class=fa-solid fa-user-tie/i
                div id=facade-labelFACADE/div
                !-- The Simple Button --
                div id=order-btnORDER/div
            /div
        /div

        !-- The Result --
        div id=final-pizza
            i class=fa-solid fa-box-open/i
        /div

        !-- Subtitles --
        div id=subtitle-container
            div id=subtitle-text/div
        /div

    /div

    script
        // Initialize Timeline - PAUSED by default
        window.tl = anime.timeline({
            autoplay: false,
            easing: 'easeOutExpo'
        });

        const subText = document.getElementById('subtitle-text');
        const subContainer = document.getElementById('subtitle-container');

        // Helper to update text
        function setSub(text) {
            subText.innerHTML = text;
        }

        // Helper to show/hide subtitle container
        function showSub(show) {
            anime({
                targets: subContainer,
                opacity: show ? 1 : 0,
                duration: 300,
                easing: 'linear'
            });
        }

        // --- TIMELINE ORCHESTRATION --- //
        // All timestamps converted from VTT to milliseconds
        
        // 00:00:00.000 - Start
        window.tl
        .add({
            targets: '#subtitle-container',
            opacity: 1,
            duration: 500,
            begin: () = setSub(Imagine you want to order a pizza)
        }, 0)
        
        // Scene 1: Enter Customer (0ms)
        .add({
            targets: '#customer',
            translateY: [-200, 0],
            opacity: [0, 1],
            easing: 'easeOutBounce',
            duration: 1500
        }, 100)
        
        // Thought bubble pops (1000ms)
        .add({
            targets: '#thought-bubble',
            scale: [0, 1],
            easing: 'spring(1, 80, 10, 0)',
            duration: 1000
        }, 1200)

        // 00:00:02.740 - Inside the restaurant it's total chaos
        .add({
            begin: () = setSub(Inside the restaurant it's total chaos)
        }, 2740)

        // Show Kitchen (2740ms) - Slide stage left to reveal kitchen on right
        .add({
            targets: '#kitchen',
            opacity: [0, 1],
            scale: [0.8, 1],
            duration: 1000
        }, 2800)

        // 00:00:05.320 - Chefs are chopping, ovens are burning...
        .add({
            begin: () = setSub(Chefs are chopping, ovens are burning, and people are rushing around)
        }, 5320)

        // ANIMATE CHAOS (5320ms onwards)
        .add({
            targets: '.chaos-item',
            translateX: function() { return anime.random(-50, 50); },
            translateY: function() { return anime.random(-50, 50); },
            scale: function() { return anime.random(0.8, 1.5); },
            rotate: function() { return anime.random(-45, 45); },
            duration: 500,
            loop: 6, // Runs for about 3 seconds
            direction: 'alternate',
            easing: 'easeInOutQuad'
        }, 5320)

        // 00:00:09.000 - But luckily you don't have to deal with that mess
        .add({
            begin: () = setSub(But luckily you don't have to deal with that mess)
        }, 9000)

        // Drop the Wall (9000ms)
        .add({
            targets: '#wall',
            translateY: ['-100%', '0%'],
            duration: 1500,
            easing: 'easeOutBounce'
        }, 9200)

        // 00:00:12.100 - You just talk to one person at the counter
        .add({
            begin: () = setSub(You just talk to one person at the counter)
        }, 12100)

        // Show Facade Guy (12200ms)
        .add({
            targets: '#facade-actor',
            opacity: [0, 1],
            scale: [0, 1],
            duration: 1000
        }, 12200)

        // 00:00:15.420 - In computer code that person is called a facade
        .add({
            begin: () = setSub(In computer code that person is called a span style='color:var(--primary)'facade/span)
        }, 15420)

        // Show Label (15500ms)
        .add({
            targets: '#facade-label',
            opacity: [0, 1],
            translateY: [20, 0],
            duration: 800
        }, 15500)

        // 00:00:18.739 - It takes a bunch of complicated steps and hides them...
        .add({
            begin: () = setSub(It takes a bunch of complicated steps and hides them behind one simple button)
        }, 18739)

        // Wires connect from back (visualize complexity hiding) (19000ms)
        .add({
            targets: '.wire',
            width: [0, 300],
            opacity: [0, 1],
            delay: anime.stagger(200),
            duration: 1000
        }, 19000)

        // Show Simple Button (20000ms)
        .add({
            targets: '#order-btn',
            scale: [0, 1],
            opacity: 1,
            rotate: '1turn',
            duration: 1500
        }, 20000)

        // 00:00:23.520 - So you get the pizza without the panic
        .add({
            begin: () = setSub(So you get the pizza without the panic)
        }, 23520)

        // Button Press Animation (23600ms)
        .add({
            targets: '#order-btn',
            scale: 0.9,
            duration: 100,
            direction: 'alternate',
            easing: 'linear'
        }, 23600)

        // Pizza Delivery (24000ms) - Moves from Facade to Customer
        .add({
            targets: '#final-pizza',
            opacity: [0, 1],
            left: ['55%', '15%'], // From Facade (55%) to Customer (15%)
            scale: [0, 1.5],
            rotate: '2turn',
            duration: 2000,
            easing: 'easeInOutQuad'
        }, 24000)

        // Cleanup
        .add({
            begin: () = showSub(false)
        }, 26000);

        // Developer note: Use window.tl.play() in console to test.
        console.log(Animation loaded. Type window.tl.play() to start.);
    /script
/body
/html" class="video-iframe" title="Video Preview" sandbox="allow-scripts allow-same-origin